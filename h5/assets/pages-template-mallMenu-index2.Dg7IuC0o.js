import{_ as t,c as e,w as s,i,r as l,A as a,a as o,o as r,g as c,m as n,n as u,S as h,h as m,F as d,j as g,aS as p,R as f,t as b,k as T}from"./index-D5wegx8A.js";import{c as w}from"./classify.data.DNdyMZts.js";const _=t({data:()=>({scrollTop:0,oldScrollTop:0,current:0,menuHeight:0,menuItemHeight:0,itemId:"",tabbar:w,menuItemPos:[],arr:[],scrollRightTop:0,timer:null}),onLoad(){},onReady(){this.getMenuItemTop()},methods:{async swichMenu(t){0==this.arr.length&&await this.getMenuItemTop(),t!=this.current&&(this.scrollRightTop=this.oldScrollTop,this.$nextTick(function(){this.scrollRightTop=this.arr[t],this.current=t,this.leftMenuStatus(t)}))},getElRect(t,e){new Promise((s,i)=>{uni.createSelectorQuery().in(this).select("."+t).fields({size:!0},i=>{i?(this[e]=i.height,s()):setTimeout(()=>{this.getElRect(t)},10)}).exec()})},async observer(){this.tabbar.map((t,e)=>{uni.createIntersectionObserver(this).relativeTo(".right-box",{top:0}).observe("#item"+e,t=>{if(t.intersectionRatio>0){let e=t.id.substring(4);this.leftMenuStatus(e)}})})},async leftMenuStatus(t){this.current=t,0!=this.menuHeight&&0!=this.menuItemHeight||(await this.getElRect("menu-scroll-view","menuHeight"),await this.getElRect("u-tab-item","menuItemHeight")),this.scrollTop=t*this.menuItemHeight+this.menuItemHeight/2-this.menuHeight/2},getMenuItemTop(){new Promise(t=>{uni.createSelectorQuery().selectAll(".class-item").boundingClientRect(e=>{e.length?e.forEach(s=>{this.arr.push(s.top-e[0].top),t()}):setTimeout(()=>{this.getMenuItemTop()},10)}).exec()})},async rightScroll(t){this.oldScrollTop=t.detail.scrollTop,0==this.arr.length&&await this.getMenuItemTop(),this.timer||(this.menuHeight||await this.getElRect("menu-scroll-view","menuHeight"),setTimeout(()=>{this.timer=null;let e=t.detail.scrollTop+this.menuHeight/2;for(let t=0;t<this.arr.length;t++){let s=this.arr[t],i=this.arr[t+1];if(!i||e>=s&&e<i)return void this.leftMenuStatus(t)}},10))}}},[["render",function(t,w,_,I,S,v){const y=l(o("up-icon"),a),R=n,H=i,M=h,x=T;return r(),e(H,{class:"u-wrap"},{default:s(()=>[c(H,{class:"u-search-box"},{default:s(()=>[c(H,{class:"u-search-inner"},{default:s(()=>[c(y,{name:"search",color:"#909399",size:28}),c(R,{class:"u-search-text"},{default:s(()=>[u("搜索")]),_:1})]),_:1})]),_:1}),c(H,{class:"u-menu-wrap"},{default:s(()=>[c(M,{"scroll-y":"","scroll-with-animation":"",class:"u-tab-view menu-scroll-view","scroll-top":S.scrollTop,"scroll-into-view":S.itemId},{default:s(()=>[(r(!0),m(d,null,g(S.tabbar,(t,i)=>(r(),e(H,{key:i,class:f(["u-tab-item",[S.current==i?"u-tab-item-active":""]]),onClick:p(t=>v.swichMenu(i),["stop"])},{default:s(()=>[c(R,{class:"u-line-1"},{default:s(()=>[u(b(t.name),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["scroll-top","scroll-into-view"]),c(M,{"scroll-top":S.scrollRightTop,"scroll-y":"","scroll-with-animation":"",class:"right-box",onScroll:v.rightScroll},{default:s(()=>[c(H,{class:"page-view"},{default:s(()=>[(r(!0),m(d,null,g(S.tabbar,(t,i)=>(r(),e(H,{class:"class-item",id:"item"+i,key:i},{default:s(()=>[c(H,{class:"item-title"},{default:s(()=>[c(R,null,{default:s(()=>[u(b(t.name),1)]),_:2},1024)]),_:2},1024),c(H,{class:"item-container"},{default:s(()=>[(r(!0),m(d,null,g(t.foods,(t,i)=>(r(),e(H,{class:"thumb-box",key:i},{default:s(()=>[c(x,{class:"item-menu-image",src:t.icon,mode:""},null,8,["src"]),c(H,{class:"item-menu-name"},{default:s(()=>[u(b(t.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["id"]))),128))]),_:1})]),_:1},8,["scroll-top","onScroll"])]),_:1})]),_:1})}],["__scopeId","data-v-5f859fcc"]]);export{_ as default};
