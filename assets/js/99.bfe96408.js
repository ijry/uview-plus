(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{424:function(e,t,i){"use strict";i.r(t);var a=i(292),l=i.n(a),s={data:()=>({id:"",adDialog:!1,qrDialog:!1,qrUrl:"",watchEnd:!1,loadingInstance:null,timer:null,check:null,whiteList:["/user/login.html"]}),created(){},mounted(){setTimeout(()=>{this.checkVip()},1e3),this.init(),this.timer||(this.timer=setInterval(()=>{},1e4)),this.check=setInterval(()=>{this.checkDisplay()},5e3)},beforeDestroy(){clearInterval(this.check)},watch:{$route(e,t){this.checkVip()}},methods:{inWl(){return!!this.$route.path.startsWith("/guide/")||(!!this.$route.path.startsWith("/cooperation/")||(!!this.$route.path.startsWith("/user/")||this.whiteList.includes(this.$route.path)))},checkVip(){if(this.inWl())this.qrDialog=!1;else{if("undefined"!=typeof window&&window.localStorage){let e=localStorage.getItem("adExpire2");if(!e||Date.parse(new Date)/1e3>e||e-Date.parse(new Date)/1e3>43200)return void this.watchAd()}this.qrDialog=!1}},openDialog(){this.qrDialog=!0},init(){new MutationObserver(e=>{for(const t of e)if("childList"===t.type){document.querySelectorAll(".v-modal"),document.querySelectorAll(".el-dialog__wrapper")}}).observe(document.body,{childList:!0,subtree:!0})},checkDisplay(){const e=document.getElementById("vip-box");if(console.log(e),!e)return alert("请关闭广告屏蔽器支持我们！"),alert("请关闭广告屏蔽器支持我们！"),alert("请关闭广告屏蔽器支持我们！"),void(document.documentElement.style.opacity="0");let t=document.getElementsByClassName("v-modal");t[0].style&&t[0].style.visibility&&"hidden"==t[0].style.visibility&&(document.documentElement.style.opacity="0",alert("请关闭广告屏蔽器支持我们1！"),t[0].style.visibility="visible");let i=document.getElementsByClassName("el-dialog__wrapper");i[0].style&&i[0].style.visibility&&"hidden"==i[0].style.visibility&&(document.documentElement.style.opacity="0",alert("请关闭广告屏蔽器支持我们2！"),i[0].style.visibility="visible");let a=document.getElementsByClassName("v-modal")[0].style.zIndex;a>-1e3&&a<0&&(alert("请关闭广告屏蔽器支持我们3！"),document.documentElement.style.opacity="0");let l=document.getElementsByClassName("el-dialog__wrapper")[0].style.zIndex;l>-1e3&&l<0&&(alert("请关闭广告屏蔽器支持我们4！"),document.documentElement.style.opacity="0");const s=document.querySelectorAll(".adsbygoogle");s.length>0&&s.forEach(e=>{window.getComputedStyle(e)});for(var o=document.getElementsByClassName("v-modal"),r=0;r<o.length;r++){if("none"===window.getComputedStyle(o[r]).display)document.documentElement.style.opacity="0",alert("请关闭广告屏蔽器支持我们谢谢6！")}},formatDate(){let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},async watchAd(){let e={};if(localStorage){let t=localStorage.getItem("userState");t&&"null"!=t&&(t=JSON.parse(t),e.Authorization=t.token)}try{let t=localStorage.getItem("id-"+this.formatDate());l.a.post("https://uiadmin.net/api/v1/wxapp/ad/add",{id:t||""},{headers:e}).then(e=>{let t=e.data;200===t.code?t.data.isVip?(this.qrDialog=!1,this.watchEnd=!0,clearInterval(this.check),localStorage.setItem("adExpire2",Date.parse(new Date)/1e3+43200),this.$message.success("免微信弹窗广告会员生效")):(this.id=t.data.id,localStorage.setItem("id-"+this.formatDate(),this.id),this.qrUrl=t.data.base64,this.qrDialog=!0):this.$message.error("出错"+t.msg)})}catch(e){console.log(e),this.$message.error("请求出错")}},async checkEnd(){l.a.post("https://uiadmin.net/api/v1/wxapp/ad/check?id="+this.id,{wxnickname:""}).then(e=>{let t=e.data;200===t.code?(this.watchEnd=!0,localStorage.setItem("adExpire2",Date.parse(new Date)/1e3+43200),this.qrDialog=!1):this.$message.error(t.msg)})}}},o=i(6),r=Object(o.a)(s,(function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{ref:"myElement",staticClass:"novip",attrs:{id:"vip-box",title:"广告",visible:e.qrDialog,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.qrDialog=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",[t("div",[e._v("验证阶段，非必要情况，请勿关闭页面或者刷新页面。")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.checkEnd.apply(null,arguments)}}},[e._v("已经看完")])],1)]},proxy:!0}])},[t("div",[t("h3",[e._v("请使用微信扫码")]),e._v(" "),t("div",{staticClass:"mt-1"},[e._v("扫码后请点击“打开广告”蓝色按钮")]),e._v(" "),t("div",{staticClass:"mt-1"},[e._v("如遇到广告问题可加QQ598821125")]),e._v(" "),t("div",[e._v("\n        感谢对开源软件的支持与理解，现阶段观看广告将有助于uview-plus的可持续发展，特别是在鸿蒙、uni-app-x等方面的开发，我们也在积极探索更好的可持续发展模式，以投入更多的研发能力便于提供更加好用的框架。收集了大家的意见反馈我们正在规划推出社区发帖获得免广告点数，自媒体发短视频教程获得广告点数，提交FastView可视化模板送广告点数，提交项目线上案例送广告点数，帮助其它用户解决问题送广告点数等多种方法，希望能够适应不同的需求，并且能积极推动uview-plus发展。\n      ")]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.qrUrl,expression:"qrUrl ? false : true"}],staticClass:"pt-3"},[e.qrUrl?t("img",{attrs:{src:e.qrUrl,alt:"mind"}}):e._e()]),e._v(" "),t("div",{staticClass:"mb-3"},[t("router-link",{staticClass:"mb-4 flex justify-center items-center flex-col",attrs:{to:e.$withBase("/user/vip")}},[e._v("\n          如果实在不想观看广告，应部分用户需求现已支持开通会员去广告。\n        ")])],1)])])],1)}),[],!1,null,null,null);t.default=r.exports}}]);