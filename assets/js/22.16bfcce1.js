(window.webpackJsonp=window.webpackJsonp||[]).push([[22,26,101],{288:function(e,t,s){"use strict";var a=s(292),r=s.n(a),i=s(73);let n={request:async(e,t)=>{let s=localStorage.getItem("userState");s&&(s=JSON.parse(s)),console.log("userState",s);let a="";"string"==typeof e?t.url=e:t=e,t.url.startsWith("/")&&(a="https://fastview.lingyun.net/api"+t.url);const i={"Content-Type":"application/json",Authorization:s?s.token:""};let n=(await r()(a,{method:t.method,data:t&&t.data?t.data:{},params:t&&t.params?t.params:{},headers:i})).data;if(401!=n.code)return n;alert("未登录")},formatTime:function(e,t){return n.timeFormat(e,t)},timeFormat:function(e,t){if(!e)return"";t||(t="yyyy-MM-dd HH:mm");let s="";if("object"==typeof e)s=e;else{if("number"!=typeof e)return e;s=new Date(1e3*e)}/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds()};for(let e in a)if(new RegExp(`(${e})`).test(t)){let s=a[e]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?s:n.padLeftZero(s))}return t},padLeftZero:function(e){return("00"+e).substr(e.length)},showToast:function(e){Object(i.Message)(e.msg)}};t.a=n},306:function(e,t,s){"use strict";s.r(t);var a=s(288),r={name:"xySendVerify",props:{verifyUser:{type:[Boolean,Number],default:!1},noNeedAccount:{type:Boolean,default:!1},account:{type:String,default:""},title:{type:String,default:""},url:{type:String,default:"/v1/sms/verify/send"},type:{type:String,default:""},time:{type:Number,default:30},capthaOptions:Object},data(){return{CaptchaId:"",label:this.$t("Send"),timeLeft:0,capthaOptionsData:{}}},created:function(){this.type||(this.type=this.$t("mobile"))},methods:{$t:e=>e,captchaSuccess(){this.sendVerify()},doClick(e){this.timeLeft>0&&e.stopPropagation(),this.account||this.noNeedAccount||(this.$message(this.$t("Please enter")+this.type),e.stopPropagation())},async sendVerify(){if(this.timeLeft>0)return;if(!this.account&&!this.noNeedAccount)return this.$message(this.$t("Please enter")+this.type),!1;this.timeLeft=this.time,this.label=this.$t("left")+this.timeLeft+"s";var e=setInterval(()=>{this.timeLeft--,this.timeLeft<=0?(this.label=this.$t("Send"),this.timeLeft=0,clearInterval(e)):this.label=this.$t("left")+this.timeLeft+"s"},1e3);let t={};t=this.type==this.$t("mobile")?{mobile:this.account,title:this.title}:{email:this.account,title:this.title},t.verifyUser=this.verifyUser,alert(this.url);const s=await a.a.request(this.url,{method:"post",data:t});"200"==s.code?(this.$message(s.msg),this.$emit("verifysuccess",s.data)):this.$message(s.msg)}}},i=s(6),n=Object(i.a)(r,(function(){var e=this._self._c;return e("span",{on:{click:this.captchaSuccess}},[e("span",{staticClass:"send-verify p-l-xs p-r-xs lh-1 cursor-pointer",attrs:{id:this.CaptchaId,type:"text"}},[e("span",{on:{click:this.doClick}},[this._v(this._s(this.label))])])])}),[],!1,null,"f9709f04",null);t.default=n.exports},318:function(e,t,s){"use strict";s.r(t);var a=s(288),r={name:"LingyunLogin",props:{},components:{xySendVerify:s(306).default},emits:["login-success","reg-success"],data(){return{baseUrl:"",readonly:!1,currrentTab:"login",qrloginShow:!1,verifyData:"",loginForm:{rememberLogin:!1,loading:!1,account:"",password:""},ruleLogin:{account:[{required:!0,message:"请填写账号",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}]},regData:{email:"",password:"",verify:"",token:"",agreement:!1,loading:!1},regRule:{email:[{required:!0,message:this.$t("Please enter")+" "+this.$t("email"),trigger:"blur"}],password:[{required:!0,message:this.$t("Please enter")+" "+this.$t("password"),trigger:"blur"},{type:"string",min:6,message:this.$t("password")+" "+this.$t("password_length"),trigger:"blur"}],verify:[{required:!0,message:this.$t("Please enter")+" "+this.$t("verify_code"),trigger:"blur"}],token:[{required:!0,message:this.$t("please")+this.$t("send")+this.$t("verify_code"),trigger:"blur"}]}}},methods:{$t:e=>e,getVerifyTokenReg(e){this.regData.token=e.token},handleLoginSubmit:async function(){if(this.loginForm.loading)return;let e=this.loginForm;this.loginForm.loading=!0;let t=this;setTimeout((function(){t.loginForm.loading=!1}),5e3);const s=await a.a.request("/v1/core/user/login",{method:"post",data:e});200==s.code?(this.$message(s.msg),this.$emit("login-success",s.data)):this.$message(s.msg),this.loginForm.loading=!1},async handleRegSubmit(){if(!this.regData.agreement)return this.$message(this.$t("You need agree terms")),!1;this.regData.loading=!0;let e=this;setTimeout((function(){e.regData.loading=!1}),5e3);const t=await a.a.request("/v1/reg_email/user/register",{method:"post",data:this.regData});"200"==t.code?(this.$message(t.msg),this.$emit("reg-success",t)):this.$message(t.msg),this.regData.loading=!1}}},i=s(6),n=Object(i.a)(r,(function(){var e=this,t=e._self._c;return t("el-tabs",{attrs:{stretch:!1},model:{value:e.currrentTab,callback:function(t){e.currrentTab=t},expression:"currrentTab"}},[t("el-tab-pane",{attrs:{label:e.$t("Login"),name:"login"}},[e.qrloginShow?e._e():t("el-form",{ref:"loginForm",staticClass:"pt-4",attrs:{size:"large","inline-message":"",model:e.loginForm,rules:e.ruleLogin}},[t("el-form-item",{attrs:{prop:"account"}},[t("el-input",{attrs:{type:"text","prefix-icon":"User",placeholder:e.$t("Email/Mobile/Username")},model:{value:e.loginForm.account,callback:function(t){e.$set(e.loginForm,"account",t)},expression:"loginForm.account"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password","prefix-icon":"Lock",placeholder:e.$t("Please enter")+" "+e.$t("password")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),t("el-button",{staticClass:"w-full submit-btn",attrs:{id:"Captcha",size:"large",loading:e.loginForm.loading,type:"default"},on:{click:e.handleLoginSubmit}},[e._v("\n                "+e._s(e.$t("Login"))+"\n            ")]),e._v(" "),t("div",{staticClass:"actions mt-4 flex justify-between"},[t("div",[t("a",{attrs:{to:e.baseUrl+"/user/resetPassword"}},[e._v(e._s(e.$t("Forget password")))])]),e._v(" "),t("div",[e._v("\n                    "+e._s(e.$t("No Account"))+"？\n                    "),t("span",{on:{click:function(t){e.currrentTab="register"}}},[e._v(e._s(e.$t("Sign up")))])])])],1)],1),e._v(" "),t("el-tab-pane",{attrs:{label:e.$t("Sign up"),name:"register"}},[t("el-form",{ref:"form",staticClass:"pt-4",attrs:{"inline-message":"",model:e.regData,rules:e.regRule}},[t("el-form-item",{attrs:{prop:"email"}},[t("el-input",{attrs:{size:"large",type:"text","prefix-icon":"Message",placeholder:e.$t("Please enter")+" "+e.$t("email")},model:{value:e.regData.email,callback:function(t){e.$set(e.regData,"email",t)},expression:"regData.email"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"verify"}},[t("el-input",{attrs:{size:"large",autocomplete:"off",type:"text","prefix-icon":"Lock",placeholder:e.$t("Please enter")+" "+e.$t("verify code")},scopedSlots:e._u([{key:"append",fn:function(){return[t("xy-send-verify",{attrs:{url:e.baseUrl+"/v1/email/verify/send",type:e.$t("email"),account:e.regData.email,title:e.$t("Sign up")},on:{verifysuccess:e.getVerifyTokenReg}})]},proxy:!0}]),model:{value:e.regData.verify,callback:function(t){e.$set(e.regData,"verify",t)},expression:"regData.verify"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{size:"large",type:"password","prefix-icon":"Lock",placeholder:e.$t("Please enter")+" "+e.$t("password")},model:{value:e.regData.password,callback:function(t){e.$set(e.regData,"password",t)},expression:"regData.password"}})],1),e._v(" "),t("div",{staticClass:"agreement"},[t("el-checkbox",{model:{value:e.regData.agreement,callback:function(t){e.$set(e.regData,"agreement",t)},expression:"regData.agreement"}},[e._v(e._s(e.$t("I have read and agree")))]),e._v(" "),t("a",{attrs:{to:e.baseUrl+"/agreement/agreement",target:"_blank"}},[e._v("\n                    《"+e._s(e.$t("User Terms"))+"》\n                ")]),e._v("\n                "+e._s(e.$t("and"))+"\n                "),t("router-link",{attrs:{to:e.baseUrl+"/agreement/privacy",target:"_blank"}},[e._v("\n                    《"+e._s(e.$t("Privacy Policy"))+"》\n                ")])],1),e._v(" "),t("el-button",{staticClass:"w-full mt-3 submit-btn",attrs:{size:"large",loading:e.regData.loading,type:"default"},on:{click:e.handleRegSubmit}},[e._v("\n                "+e._s(e.$t("Sign up"))+"\n            ")]),e._v(" "),t("div",{staticClass:"actions mt-4 flex"},[t("div"),e._v(" "),t("div",[e._v("\n                    "+e._s(e.$t("Existing account"))+"？\n                    "),t("span",{on:{click:function(t){e.currrentTab="login"}}},[e._v(e._s(e.$t("Login")))])])])],1)],1)],1)}),[],!1,null,null,null);t.default=n.exports},565:function(e,t,s){"use strict";s.r(t);var a={name:"Login",components:{lingyunLogin:s(318).default},data:()=>({}),methods:{userSuccess(e){localStorage.setItem("userState",JSON.stringify(e)),this.$router.push({path:"/"})}}},r=s(6),i=Object(r.a)(a,(function(){var e=this._self._c;return e("div",[e("h1",[this._v("登录")]),this._v(" "),e("lingyunLogin",{on:{"reg-success":this.userSuccess,"login-success":this.userSuccess}})],1)}),[],!1,null,null,null);t.default=i.exports}}]);